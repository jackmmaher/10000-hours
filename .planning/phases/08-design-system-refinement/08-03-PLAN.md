---
phase: 08-design-system-refinement
plan: 03
type: execute
domain: design-ui-skills
---

<objective>
Extract a reusable Button component with complete interactive states (hover, active, focus-visible, disabled) and semantic variants.

Purpose: Currently button styles are repeated across components with inconsistent states. The Human-Crafted Design skill requires ALL button states implemented consistently. Extracting to a component enforces this.
Output: Button.tsx component with primary, secondary, ghost, and danger variants, all with complete state coverage.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./08-03-SUMMARY.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-design-system-refinement/08-01-SUMMARY.md
@.planning/phases/08-design-system-refinement/08-02-SUMMARY.md

**Source files:**
@src/components/Card.tsx
@src/components/AuthModal.tsx
@src/components/Settings.tsx

**Analysis context:**
Current button patterns found in codebase:
1. Primary (dark bg, light text): `bg-ink text-cream rounded-xl hover:bg-ink/90 active:scale-[0.98] disabled:opacity-50`
2. Secondary (light bg, dark text): `bg-white text-ink border border-ink/10 rounded-xl hover:bg-cream-dark active:scale-[0.98]`
3. Ghost (text only): `text-ink/40 hover:text-ink/60 transition-colors`
4. Danger (red): Not consistently implemented

**Skill requirements for ALL buttons:**
- Default state
- Hover state (visible change)
- Active state (pressed feedback within 100ms)
- Focus-visible state (keyboard navigation - 2px outline, 2px offset)
- Disabled state (opacity 0.5, cursor not-allowed)

**Missing in current impl:**
- Some buttons lack focus-visible
- Ghost buttons inconsistent hover/active
- No reusable component
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Button.tsx component with all variants and states</name>
  <files>src/components/Button.tsx</files>
  <action>
Create new Button component with:

```tsx
/**
 * Button - Design system button with complete interactive states
 *
 * Implements Human-Crafted Design skill requirements:
 * - All states: default, hover, active, focus-visible, disabled
 * - Semantic variants: primary, secondary, ghost, danger
 * - Consistent timing (150ms transitions)
 */

import { ButtonHTMLAttributes, forwardRef } from 'react'
import { useTapFeedback } from '../hooks/useTapFeedback'

type ButtonVariant = 'primary' | 'secondary' | 'ghost' | 'danger'
type ButtonSize = 'sm' | 'md' | 'lg'

interface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: ButtonVariant
  size?: ButtonSize
  /** Full width button */
  fullWidth?: boolean
  /** Loading state - shows spinner, disables interaction */
  loading?: boolean
}

const variantStyles: Record<ButtonVariant, string> = {
  primary: `
    bg-[var(--button-primary-bg)] text-[var(--button-primary-text)]
    hover:brightness-110
    active:brightness-95 active:scale-[0.98]
  `,
  secondary: `
    bg-[var(--button-secondary-bg)] text-[var(--button-secondary-text)]
    border border-[var(--border)]
    hover:bg-[var(--bg-deep)]
    active:bg-[var(--bg-base)] active:scale-[0.98]
  `,
  ghost: `
    bg-transparent text-[var(--text-secondary)]
    hover:text-[var(--text-primary)] hover:bg-[var(--bg-deep)]
    active:bg-[var(--bg-base)] active:scale-[0.98]
  `,
  danger: `
    bg-red-500 text-white
    hover:bg-red-600
    active:bg-red-700 active:scale-[0.98]
  `,
}

const sizeStyles: Record<ButtonSize, string> = {
  sm: 'px-3 py-1.5 text-caption rounded-lg',
  md: 'px-4 py-2.5 text-body rounded-xl',
  lg: 'px-6 py-3.5 text-body rounded-xl',
}

export const Button = forwardRef<HTMLButtonElement, ButtonProps>(
  (
    {
      variant = 'primary',
      size = 'md',
      fullWidth = false,
      loading = false,
      disabled,
      className = '',
      children,
      onClick,
      ...props
    },
    ref
  ) => {
    const haptic = useTapFeedback()

    const handleClick = (e: React.MouseEvent<HTMLButtonElement>) => {
      if (disabled || loading) return
      haptic.light()
      onClick?.(e)
    }

    return (
      <button
        ref={ref}
        className={`
          inline-flex items-center justify-center gap-2
          font-medium
          transition-all duration-150 ease-out
          touch-manipulation
          focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[var(--accent)]
          disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none
          ${variantStyles[variant]}
          ${sizeStyles[size]}
          ${fullWidth ? 'w-full' : ''}
          ${className}
        `}
        disabled={disabled || loading}
        onClick={handleClick}
        {...props}
      >
        {loading && (
          <svg
            className="w-4 h-4 animate-spin"
            fill="none"
            viewBox="0 0 24 24"
          >
            <circle
              className="opacity-25"
              cx="12"
              cy="12"
              r="10"
              stroke="currentColor"
              strokeWidth="4"
            />
            <path
              className="opacity-75"
              fill="currentColor"
              d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"
            />
          </svg>
        )}
        {children}
      </button>
    )
  }
)

Button.displayName = 'Button'
```

Key design decisions:
- Uses CSS variables for theme awareness
- 150ms transitions per skill recommendation
- Complete focus-visible with accent color outline
- Haptic feedback integrated
- Loading state with spinner
- forwardRef for form integration
  </action>
  <verify>cat src/components/Button.tsx shows complete component with all variants</verify>
  <done>Button.tsx created with primary/secondary/ghost/danger variants and all states</done>
</task>

<task type="auto">
  <name>Task 2: Migrate AuthModal buttons to new Button component</name>
  <files>src/components/AuthModal.tsx</files>
  <action>
Replace the inline button styles with the new Button component.

1. Add import at top:
```tsx
import { Button } from './Button'
```

2. Replace Apple sign-in button (~line 81-89):
From:
```tsx
<button
  onClick={handleAppleSignIn}
  disabled={isLoading}
  className="w-full flex items-center justify-center gap-3 py-3.5 px-4 bg-ink text-cream rounded-xl font-medium transition-all hover:bg-ink/90 active:scale-[0.98] disabled:opacity-50"
>
```
To:
```tsx
<Button
  variant="primary"
  size="lg"
  fullWidth
  loading={isLoading}
  onClick={handleAppleSignIn}
>
```

3. Replace Google sign-in button (~line 93-105):
From:
```tsx
<button
  onClick={handleGoogleSignIn}
  disabled={isLoading}
  className="w-full flex items-center justify-center gap-3 py-3.5 px-4 bg-white text-ink border border-ink/10 rounded-xl font-medium transition-all hover:bg-cream-dark active:scale-[0.98] disabled:opacity-50"
>
```
To:
```tsx
<Button
  variant="secondary"
  size="lg"
  fullWidth
  loading={isLoading}
  onClick={handleGoogleSignIn}
>
```

4. Replace "Maybe later" button (~line 116-120):
From:
```tsx
<button
  onClick={onClose}
  className="w-full mt-6 py-3 text-sm text-ink/40 hover:text-ink/60 transition-colors"
>
```
To:
```tsx
<Button
  variant="ghost"
  fullWidth
  onClick={onClose}
  className="mt-6"
>
```

Keep the icon SVGs inside the Button children.
  </action>
  <verify>grep "Button variant" src/components/AuthModal.tsx shows Button usage; grep "className=\"w-full flex items-center justify-center" src/components/AuthModal.tsx returns nothing</verify>
  <done>AuthModal uses Button component for all buttons</done>
</task>

<task type="auto">
  <name>Task 3: Export Button from components index</name>
  <files>src/components/index.ts</files>
  <action>
Check if src/components/index.ts exists.

If it exists, add:
```tsx
export { Button } from './Button'
```

If it doesn't exist, create it with:
```tsx
// Design system components
export { Button } from './Button'
export { Card, CardHeader, CardBody, CardFooter, CardEngagement, CardTitle, CardDescription, CardMeta, PearlOrb, AccentBar } from './Card'
```

This establishes the pattern for a component library export.
  </action>
  <verify>grep "Button" src/components/index.ts shows export (or file created with export)</verify>
  <done>Button exported from components index for easy importing</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cat src/components/Button.tsx` shows complete component
- [ ] `grep "import { Button }" src/components/AuthModal.tsx` shows import
- [ ] `npm run build` succeeds without errors
- [ ] AuthModal renders correctly with new Button component
- [ ] All button states work (hover, active, focus-visible, disabled)
</verification>

<success_criteria>
- Button.tsx created with 4 variants and 3 sizes
- All interactive states implemented (hover, active, focus-visible, disabled)
- AuthModal migrated to use Button component
- Component exported from index
- Build passes
- Visual appearance unchanged (styles match previous inline styles)
</success_criteria>

<output>
After completion, create `.planning/phases/08-design-system-refinement/08-03-SUMMARY.md`
</output>
